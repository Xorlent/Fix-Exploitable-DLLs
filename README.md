# Fix-Exploitable-DLLs
PowerShell script to find, report, and mitigate (where possible) EXEs with exploitable DLLs  

### Summary
  _If a vulnerable Microsoft DLL is properly code-signed, the script will auto-remediate the vulnerability_  
  Once tested successfully, I recommend running this tool on your organization's standard Windows  
  desktop deployment image, verifying all works well, then use the resulting yyyy-MM-dd_HH-mm_New.xml  
  file to deploy mitigations to the fleet, using:  
  ```Set-ProcessMitigation -PolicyFilePath .\yyyy-MM-dd_HH-mm_New.xml```

### Preparation
  - Take a full OS backup if necessary (ie. if this is not a fresh deployment image or test box)

### Installation
  - Download RemediateDLLHijack.ps1
  - Right-click on the downloaded file and select Properties
  - Unblock
  - Open an Administrator Powershell window
  - Run RemediateDLLHijack.ps1

### A remediated executable now no longer works
  - Open an Administrator Powershell window
  - For each executable you want to allow unsigned DLL loading on (exchange exename.exe for the actual executable name):  
    ```Set-ProcessMitigation -Disable MicrosoftSignedOnly -Name exename.exe```

### I need to roll back ALL changes
  - Open an Administrator Powershell window
  - Navigate to the folder where you ran the tool from
  - Execute the following commands and reboot (exchange yyy-MM-dd-HH-mm for the actual file name):  
    ```Set-ProcessMitigation -System -Reset```  
    ```Set-ProcessMitigation -PolicyFilePath .\yyyy-MM-dd_HH-mm_Original.xml```

### None of this works.  What now?
  - Restore from backup

#### This project uses [Wietze's Hijacklibs](https://github.com/wietze/HijackLibs) data to scan for vulnerabilities.  Many thanks!
